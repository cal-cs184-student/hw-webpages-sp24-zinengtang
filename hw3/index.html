<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphics Homework 3</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        img { max-width: 100%; height: auto; }
        table { border-collapse: collapse; width: 100%; }
        td, th { border: 1px solid #dddddd; text-align: left; padding: 8px; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>

<h1>Graphics Homework 3</h1> 
<p>Author: Zineng Tang</p>

<h2>Overview</h2>
	
<h1>1. Rendering Pipeline: Ray Generation and Triangle Intersection</h1>

    <h2>Ray Generation</h2>
    <p>
        Ray generation involves creating rays that originate from the camera and pass through each pixel on the image plane. The process includes:
    </p>
    <ol>
        <li><strong>Camera Position and Orientation:</strong> Determine the position and orientation of the camera in the scene.</li>
        <li><strong>Viewing Frustum:</strong> Calculate the camera's viewing frustum, defined by the field of view (FOV), aspect ratio, and near and far clipping planes.</li>
        <li><strong>Pixel Sampling:</strong> For each pixel, calculate a direction vector from the camera position through the pixel, converting pixel coordinates to world coordinates.</li>
        <li><strong>Ray Construction:</strong> Construct a ray for each pixel with the direction vector and the camera's position. These rays intersect with the scene geometry to determine visible surfaces.</li>
    </ol>

    <h2>Triangle Intersection</h2>
    <p>
        The triangle intersection algorithm determines if and where a ray intersects a triangle in the scene, based on the MÃ¶ller-Trumbore intersection algorithm:
    </p>
    <ol>
        <li><strong>Triangle Definition:</strong> Defined by its three vertices \(V_1, V_2, V_3\), calculate two edge vectors \(E_1 = V_2 - V_1\) and \(E_2 = V_3 - V_1\).</li>
        <li><strong>Determinant and Ray Direction:</strong> Calculate the determinant including the ray direction vector \(D\) and edge vectors \(E_1, E_2\) to find if the ray intersects the triangle's plane.</li>
        <li><strong>Barycentric Coordinates:</strong> Calculate the barycentric coordinates (\(u, v\)) to determine if the intersection point lies within the triangle.</li>
        <li><strong>Intersection Point:</strong> If \(0 \leq u \leq 1\), \(0 \leq v \leq 1\), and \(u + v \leq 1\), the ray intersects the triangle, determining the intersection point using \(t\).</li>
        <li><strong>Normal Calculation:</strong> Calculate the surface normal at the intersection point, which is constant for a flat triangle and calculated as the cross product of \(E_1\) and \(E_2\).</li>
    </ol>

<div style="text-align: center;">
    <figure>
        <img src="assets/1_0.png" style="width:20vw;">
	<img src="assets/1_1.png" style="width:20vw;">
	    <img src="assets/1_2.png" style="width:20vw;">
	<img src="assets/1_3.png" style="width:20vw;">
	    <img src="assets/1_4.png" style="width:20vw;">
	    <img src="assets/1_5.png" style="width:20vw;">
	    <img src="assets/1_6.png" style="width:20vw;">
	    <img src="assets/1_7.png" style="width:20vw;">
        <figcaption> Screenshots of normal shading.</figcaption>
    </figure>
</div>


	<h1>2. BVH Construction and Rendering with Normal Shading</h1>

    <h2>BVH Construction Algorithm</h2>
    <p>
        Bounding Volume Hierarchy (BVH) is a tree structure on a set of geometric objects. All geometric objects are wrapped in bounding volumes that form the leaf nodes of the tree. These nodes are then grouped as small sets and enclosed within larger bounding volumes. These, in turn, are also grouped and enclosed within other larger bounding volumes in a recursive manner until the whole scene is enclosed in a single bounding volume, forming the root of the BVH.
    </p>

    <h2>Heuristic for Picking the Splitting Point</h2>
    <p>
        The heuristic chosen for picking the splitting point in the BVH construction algorithm is the <strong>Surface Area Heuristic (SAH)</strong>. This heuristic minimizes the total cost of intersections by considering both the surface area of the bounding volumes and the number of primitives they contain. The SAH tries to find the split that minimizes the expression:
    </p>
    <p>\(Cost = C_{trav} + (P_{L} \cdot A_{L} + P_{R} \cdot A_{R}) / A_{total}\)</p>
    <ul>
        <li>\(C_{trav}\): Cost of traversing a node (fixed cost).</li>
        <li>\(P_{L}, P_{R}\): The number of primitives on the left and right side of the split.</li>
        <li>\(A_{L}, A_{R}, A_{total}\): The surface areas of the bounding volumes on the left, right, and the total surface area of the node being split.</li>
    </ul>
    <p>
        By evaluating this cost for possible splits at different positions and choosing the one with the lowest cost, the algorithm effectively balances the tree, reducing the overall number of intersection tests required during rendering.
    </p>

    <h2>Rendered Images with Normal Shading</h2>
    <p>Below are images rendered using BVH acceleration with normal shading, which significantly speeds up rendering times for complex scenes.</p>
    <div style="text-align: center;">
    <figure>
        <img src="assets/2_0.png" style="width:20vw;">
	<img src="assets/2_1.png" style="width:20vw;">
	<img src="assets/2_2.png" style="width:20vw;">
	    <img src="assets/2_4.png" style="width:20vw;">
	    <img src="assets/2_5.png" style="width:20vw;">
        <figcaption> Examples of large dae files.</figcaption>
    </figure>
</div>
	
</body>
</html>
